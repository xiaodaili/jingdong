"use strict";$(function(){var str=localStorage.getItem("username");if(str){var arr=JSON.parse(str),ele=arr.find(function(i){return i.username});$(".log-in").text("欢迎"+ele.username+"登录"),$(".sign-up").text("退出登录"),$(".sign-up").attr("href","javascript:;")}else $(".log-in").text("你好，请登录"),$(".sign-up").text("免费注册");$(".sign-up").on("click",function(){$(".log-in").text("你好，请登录"),$(".sign-up").text("免费注册")});var now=+new Date,skuid=location.search.match(/skuid=(\d+)/);skuid=skuid[1],$.ajax({url:"/detailgoods",data:{methods:"accessories",sku:skuid,cat:"9987,653,655",lid:1,pin:"jd_756d3cc64ebb0",ck:"pin,CipLocation,Catw,Caview",_:now},async:!1,success:function(i){var a=i.accessories.data,t=a.wName,s=a.imageUrl,e=a.wMaprice;$(".main-img img").attr("src","https://img12.360buyimg.com/n1/s450x450_"+s),$(".big-img img").attr("src","https://img12.360buyimg.com/n1/s450x450_"+s),$(".spec-item img").attr("src","https://img12.360buyimg.com/n5/s54x54_"+s),$(".sku-name").text(t),$(".main-price").text("￥"+e)},error:function(i){console.log(i)}}),$.ajax({url:"/goodsmain",data:{skuId:skuid,mainSkuId:skuid,charset:"utf-8",cdn:2,_:now},async:!1,success:function(i){var a=i.content;$(".detail-content-item").append(a)},error:function(i){console.log(i)}}),$.ajax({url:"/moregoodsinfo",data:{skuId:skuid,cat:"9987,653,655",area:"1_2901_55561_0",num:1},async:!1,success:function(i){var a;console.log(i),a='\n            <div class="news-item">'+i.ad+"</div>\n            ",$(".news").append(a)},error:function(i){console.log(i)}}),$(".choose input").val("1").blur(function(){$(this).val()<=0&&$(this).val("1")}),$.ajax({url:"/darengou",data:"pin=jd_756d3cc64ebb0&body={%22lid%22:1,%22lim%22:6,%22ec%22:%22utf-8%22,%22uuid%22:%221630062110939678747297%22,%22pin%22:%22jd_756d3cc64ebb0%22,%22p%22:103001,%22sku%22:"+skuid+",%22ck%22:%22pin,ipLocation,atw,aview%22,%22c1%22:9987,%22c2%22:653,%22c3%22:655}&appid=pc&functionId=mixer&t=1633315588752&_=1633315588752",async:!1,dataType:"text",success:function success(res){var str="";res=eval("("+res+")");for(var i=0;i<res.data.length;i++){var _res$data$i=res.data[i],img=_res$data$i.img,t=_res$data$i.t,jp=_res$data$i.jp;str+='\n                <li class="fore1">\n                    <div class="p-img">\n                        <a href="">\n                            <img src="https://img11.360buyimg.com/n1/s180x180_'+img+'" alt="">\n                        </a>\n                    </div>\n                    <div class="p-name">\n                        <a href="javascript:;">'+t+'</a>\n                    </div>\n                    <div class="p-price">\n                        <strong>'+jp+"</strong>\n                    </div>\n                </li>\n                "}$(".plist").append(str),console.log(res.data)},error:function(i){console.log(i)}}),$(".addshopcar").click(function(){if("你好，请登录"==!$(".log-in").text())alert("请您先登录"),location.href="./login.html";else{var i=$(".choose input").val(),a=localStorage.getItem("data"),t=localStorage.getItem("username"),s=(o=JSON.parse(t).find(function(i){return i.username})).username,e={skuId:skuid,username:s,num:i},n=[];if(a){var o;if(o=(n=JSON.parse(a)).find(function(i){return i.skuId===skuid}))return o.num=parseInt(o.num),console.log(o.num),o.num+=parseInt($(".choose input").val()),localStorage.setItem("data",JSON.stringify(n)),!1;e.num=$(".choose input").val()}else e.num=$(".choose input").val();n.push(e),localStorage.setItem("data",JSON.stringify(n))}}),$(".goumai").click(function(){var i,a=$(".choose input").val(),t=localStorage.getItem("data"),s=localStorage.getItem("username"),e=(i=JSON.parse(s).find(function(i){return i.username})).username,n={skuId:skuid,username:e,num:a},o=[];t?(i=(o=JSON.parse(t)).find(function(i){return i.skuId===skuid}))?(i.num=parseInt(i.num),i.num+=parseInt($(".choose input").val()),localStorage.setItem("data",JSON.stringify(o))):n.num=$(".choose input").val():n.num=$(".choose input").val();o.push(n),localStorage.setItem("data",JSON.stringify(o)),location.href="./carshop.html"}),$(".main-img").hover(function(){$(".mask").css("display","block"),$(".big-img").css("display","block"),$(this).mousemove(function(i){var a=i.pageX,t=i.pageY;console.log(a,t);var s=a-$(".mask").width()/2-$(".main-img img").offset().left,e=t-$(".mask").height()/2-$(".main-img img").offset().top;s<0&&(s=0),s>$(".main-img img").width()-$(".mask").width()&&(s=$(".main-img img").width()-$(".mask").width()),e<0&&(e=0),e>$(".main-img img").height()-$(".mask").height()&&(e=$(".main-img img").height()-$(".mask").height()),$(".mask").css("left",s),$(".mask").css("top",e);var n=s/($(".main-img img").width()-$(".mask").width())*($(".big-img img").width()-$(".big-img").width()),o=e/($(".main-img img").height()-$(".mask").height())*($(".big-img img").height()-$(".big-img").height());$(".big-img img").css("left",-n),$(".big-img img").css("top",-o)})},function(){$(".mask").css("display","none"),$(".big-img").css("display","none")})});